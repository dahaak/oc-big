<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="OC-Big : Big Data Integration into OpenClinica&#39;s eCRFs">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>OC-Big</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/idmteam/oc-big">View on GitHub</a>

          <h1 id="project_title">OC-Big</h1>
          <h2 id="project_tagline">Big Data Integration into OpenClinica&#39;s eCRFs</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/idmteam/oc-big/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/idmteam/oc-big/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><strong>OC-Big</strong> is an open source software extension for the electronic data capture system OpenClinica (<a href="https://www.openclinica.com/">https://www.openclinica.com/</a>) and has been developed at the Department of Medical Informatics, Uniklinik RWTH Aachen, Germany. OC-Big aims at enriching OpenClinica by a new module for convenient and context-related data integration of large volume files into electronic case report forms (eCRFs). OC-Big is developed using JavaScript (JQuery) and PHP, and is based on other open source projects, namely jQuery File Upload (<a href="http://blueimp.github.io/jQuery-File-Upload/">http://blueimp.github.io/jQuery-File-Upload/</a>) and zip.js (<a href="http://gildas-lormeau.github.io/zip.js/">http://gildas-lormeau.github.io/zip.js/</a>).</p>

<p><img src="https://community.openclinica.com/sites/fileuploads/akaza/cms-community/contribprojects/screenshot/20641/oc_db_1.png" alt="Screen 1"></p>

<p><img src="https://community.openclinica.com/sites/fileuploads/akaza/cms-community/contribprojects/screenshot/20641/oc-db_1.png" alt="Screen 2"></p>

<h1>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Features</h1>

<ul>
<li>Upload of large volume date (only limited by server’s storage space)</li>
<li>Chunking of data files into multiple parts to exceed browser’s upload limit of 4 GB</li>
<li>Support of multiple selection of files and queue processing</li>
<li>User-friendly drag &amp; drop support</li>
<li>Data storage with unique filenames including study, event and subject context</li>
<li>Automatic compression and decompression for transfer (optional)</li>
<li>Not affected by !OpenClinica’s session timeout</li>
<li>Easy to integrate in and configure through eCRFs</li>
</ul>

<h1>
<a id="installation-guide" class="anchor" href="#installation-guide" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation Guide</h1>

<h2>
<a id="system-requirements" class="anchor" href="#system-requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>System Requirements</h2>

<p>The following system requirements represent the system configuration of our server. In general, it should also work with similar components.</p>

<ul>
<li>Web server (e.g. Debian GNU/Linux 6.0)</li>
<li>OpenClinica 3.1.2 with requirements, e.g. PostreSQL, Tomcat (probably newer OpenClinica versions also working, but not tested yet)</li>
<li>Apache 2</li>
<li>PHP 5 (with PECL Zip 1.10.2)</li>
<li>Apache Tomcat Connector (mod_jk)</li>
<li>Web browser, tested with Firefox &gt;19 and Google Chrome &gt;26 (Last tested: Firefox 34.0.5, Chrome 39.0.2171.95m)</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p><strong>Attention:</strong>
In the current version, OpenClinica has to be configured to be running through the Apache (Port 80) instead of Tomcat (Port 8080) to get OC-Big working. Since OC-Big has to be running in Apache, cross domain calls would be performed during communication with OpenClinica. These calls are usually forbidden by the browsers and cannot be executed. 
The following manual assumes that OpenClinica should be also running through Apache and explains how this can be set up (step 3).</p>

<h3>
<a id="1-install-openclinica" class="anchor" href="#1-install-openclinica" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Install OpenClinica</h3>

<p>If not already done, install OpenClinica with all requirements. Installation guides for Linux/Windows can be found <a href="https://docs.openclinica.com/installation">here</a>. The following manual is based on a Linux (Debian) installation of !OpenClinica.</p>

<h3>
<a id="2-install-apache" class="anchor" href="#2-install-apache" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Install Apache</h3>

<p>Pointing the web browser to <a href="http://localhost/">http://localhost/</a> takes us to the default apache page confirming that apache has been installed. If not, the command </p>

<p><code>aptitude install apache2</code></p>

<p>will catch apache2 from the debian packages and install it. </p>

<h3>
<a id="3-install-apache-tomcat-connector" class="anchor" href="#3-install-apache-tomcat-connector" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Install Apache Tomcat Connector</h3>

<p>As explained in the introduction, we now have to configure OpenClinica to be additionally running in Apache. For this we have to forward Apache calls on Port 80 to our OpenClinica location in Tomcat on Port 8080 via mod_jk. </p>

<p>First we install mod_jk</p>

<p><code>aptitude install libapache2-mod-jk</code></p>

<p>After this, we configure the workers.properties file in <em>/etc/libapache2-mod-jk</em>. It should look like this:</p>

<p><code>workers.tomcat_home=/usr/share/tomcat7
workers.java_home=/usr/lib/jvm/default-java
ps=/
worker.list=ajp13_worker
worker.ajp13_worker.port=8009
worker.ajp13_worker.host=localhost
worker.ajp13_worker.type=ajp13
worker.ajp13_worker.lbfactor=1
worker.loadbalancer.type=lb
worker.loadbalancer.balance_workers=ajp13_worker</code></p>

<p>But, <code>workers.tomcat_home</code> and <code>workers.java_home</code> have to be adapted to your Tomcat/Java home directories.</p>

<p>After this, we configure Tomcat in so far, that it will allow mod_jk calls. For this, we uncomment the following lines in Tomcat’s <em>server.xml</em> in <em>/conf/</em> of your Tomcat root folder:</p>

<p><code>&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" /&gt;</code></p>

<p>In the next step, we have to load OpenClinica from Tomcat into Apache. For this, we modify the <em>jk.conf</em> in <em>/etc/apache2/mods-available</em> and add the following lines</p>

<p><code>JkMount /openclinica/* ajp13_worker
    JkMountCopy All</code></p>

<p>In the first line our OpenClinica web app folder <em>/openclinica/</em>(adapt this line here, if you changed the name) and all its sub-content is released for Apache forwarding.
The second lines says that this configuration should be automatically adapted to all (virtual)-hosts defined in Apache.</p>

<p>Now, we just have to restart Apache and Tomcat. After this our OpenClinica installation should be available at <a href="http://hostname/OpenClinica">http://hostname/OpenClinica</a>. In addition, it should be still available at <a href="http://hostname:8080/OpenClinica">http://hostname:8080/OpenClinica</a>, but when accessing it this way, OC-Big might not work due to cross domain calls.</p>

<h3>
<a id="4-install-php" class="anchor" href="#4-install-php" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Install PHP</h3>

<p>PHP5 is required for OC-Big to process transferred files on server side. This can be installed along with the php apache module by</p>

<p><code>aptitude install php5 libapache2-mod-php5</code></p>

<p>After this, a server restart must be done</p>

<p><code>/etc/init.d/apache2 restart</code></p>

<h3>
<a id="5-install-php-zip-extension" class="anchor" href="#5-install-php-zip-extension" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. Install PHP Zip Extension</h3>

<p>Zip functionality is not usually enabled with standard php installations. To check if the zip functionality is enabled, the <em>phpinfo()</em> function can be used. PHP's zip functionality has to be enabled by </p>

<p># compiling php with the <em>--enable-zip</em> option OR 
 # install it via PECL, e.g. install PECL, modify the <em>php.ini</em> file and uncomment zip.so. </p>

<h3>
<a id="6-extract-oc-big-112zip-to-a-temporary-folder" class="anchor" href="#6-extract-oc-big-112zip-to-a-temporary-folder" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. Extract oc-big-112.zip to a temporary folder</h3>

<p>The zip file contains the directories</p>

<ul>
<li>bin: PHP modules</li>
<li>css: Cascading Style Sheets (CSS) files for design</li>
<li>images: Images used in user interface</li>
<li>js: Used Javascript libraries</li>
<li>lib: Original source code of used projects and libraries</li>
<li>openclinica: !OpenClinica files including <em>OC-Big.xls</em> as demo eCRF</li>
<li>server: Server side PHP code to process transferred files</li>
<li>templates: HTML templates for client side</li>
</ul>

<h3>
<a id="7-copy-contents-on-server" class="anchor" href="#7-copy-contents-on-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>7. Copy contents on server</h3>

<p>Copy the complete content of oc-big-112.zip into a folder in your Apache's default document root directory (e.g /var/www/oc-big-112/).</p>

<h3>
<a id="8-set-folder-permissions" class="anchor" href="#8-set-folder-permissions" aria-hidden="true"><span class="octicon octicon-link"></span></a>8. Set folder permissions</h3>

<p>In the directories <em>/server/php/</em> and <em>/server/php/files/</em> the transferred files are stored, so these directories need write permissions (777).</p>

<h3>
<a id="9-copy-pop-up-call-script-into-your-openclinica-tomcat-folder" class="anchor" href="#9-copy-pop-up-call-script-into-your-openclinica-tomcat-folder" aria-hidden="true"><span class="octicon octicon-link"></span></a>9. Copy Pop-Up call script into your OpenClinica Tomcat folder</h3>

<p>The script <em>/openclinica/showImageUpload.js</em> has to be copied into your OpenClinica Tomcat folder. After a backup, create a folder (e.g. /javascripts/) inside the OpenClinica webapp folder and copy the script file here. This script has to be available inside Tomcat, because it is called from OpenClinica itself.</p>

<h3>
<a id="10-customize-ecrf" class="anchor" href="#10-customize-ecrf" aria-hidden="true"><span class="octicon octicon-link"></span></a>10. Customize eCRF</h3>

<p>Open the /openclinica/OC-Big.xls sample eCRF and modify it. Here a sample integration for image upload into the eCRF is already available. An overview of the parameters, which can be generally set in the eCRF is given below.</p>

<h3>
<a id="11-install-ecrf" class="anchor" href="#11-install-ecrf" aria-hidden="true"><span class="octicon octicon-link"></span></a>11. Install eCRF</h3>

<p>Install the eCRF as usual in OpenClinica.</p>

<h3>
<a id="12-ready" class="anchor" href="#12-ready" aria-hidden="true"><span class="octicon octicon-link"></span></a>12. Ready!</h3>

<h2>
<a id="settings" class="anchor" href="#settings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Settings</h2>

<p>OC-Big can be configured directly in the eCRF by modification of the upload button tag. In the sample eCRF it is as follows:</p>

<p><code>&lt;span class="uploadButton" widthQ="240px" fileType="png" fileCount="1" imgWidth="240px" imgFloat="right" imgDefault="/openclinica/crfImages/default.png" apacheBD="oc-big-112" savePath="/var/www/oc-big-112/server/php/final/” token="test1234!"/&gt;</code></p>

<p>You can modify the following parameters to adapt OC-Big to your needs:</p>

<ul>
<li>
<strong>fileType:</strong> Allowed file types for upload. Multiple types can be seperated by comma (e.g. jpg, png). <em>Note:</em> On changing this you currently also have to adapt the <em>content-type</em> in the <em>download.php</em> file to get downloads working as well.</li>
<li>
<strong>fileCount:</strong> Maximum number of allows files.<br>
</li>
<li>
<strong>imgDefault:</strong> Location of default image showed in the eCRF beside of the OC-Big button.</li>
<li>
<strong>apacheBD:</strong> Name of the OC-Big instance, which is used. If your OC-Big code is in a folder named "oc-big-112" (as described in the manual), "oc-big-111" has to be set here.</li>
<li>
<strong>savePath:</strong> Path where transferred files are finally stored. Note: On changing this you propbably also have to adapt the extraction of the filenames in <em>download.php</em>.</li>
<li>
<strong>token:</strong> Token to avoid calls of OC-Big from outside the eCRF. The token value in the eCRF and in <em>settings.php</em> have to be the same. The longer this value, the lower the risk of unwanted OC-Big calls from outside. <em>Note:</em> Please change the token value before integration. </li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">OC-Big maintained by <a href="https://github.com/idmteam">idmteam</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
